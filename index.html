<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>車両判定システム【完全版】</title>
    <style>
        :root { --blue: #00479d; --red: #e60012; --bg: #f2f2f7; --gray: #444; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding-bottom: 240px; -webkit-user-select: none; }
        .header { background: var(--blue); color: white; padding: 12px 15px; text-align: center; border-bottom: 3px solid var(--red); position: sticky; top: 0; z-index: 1000; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { margin: 0; font-size: 1rem; }
        .section-title { background: var(--gray); color: white; padding: 10px 15px; font-weight: bold; font-size: 0.85rem; position: sticky; top: 48px; z-index: 999; border-bottom: 1px solid #000; }
        .item { display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; background: white; border-bottom: 1px solid #eee; min-height: 65px; }
        .item-info { display: flex; flex-direction: column; gap: 2px; flex: 1; }
        .item-n { font-size: 0.95rem; font-weight: bold; color: #333; }
        .item-size { font-size: 0.7rem; color: #888; }
        .pts-tag { color: var(--red); font-weight: bold; font-size: 0.75rem; margin-left: 5px; }
        .ctrls { display: flex; align-items: center; gap: 8px; }
        .btn { width: 44px; height: 44px; background: #fff; border: 1px solid #ccc; font-size: 1.5rem; font-weight: bold; border-radius: 8px; box-shadow: 0 2px 0 #bbb; display: flex; align-items: center; justify-content: center; }
        .btn:active { transform: translateY(2px); box-shadow: none; background: #f0f0f0; }
        .qty-input { width: 45px; height: 40px; text-align: center; border: 1px solid #ccc; font-size: 1.2rem; font-weight: bold; border-radius: 6px; }
        .footer { position: fixed; bottom: 0; width: 100%; background: white; border-top: 5px solid var(--blue); z-index: 1001; padding-bottom: env(safe-area-inset-bottom); box-shadow: 0 -8px 20px rgba(0,0,0,0.15); }
        .price-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; padding: 10px; border-bottom: 1px solid #eee; }
        .price-box { text-align: center; background: #fdf2f2; padding: 5px; border-radius: 6px; }
        .price-label { font-size: 0.65rem; color: #666; font-weight: bold; }
        .price-val { font-size: 1.2rem; font-weight: bold; color: var(--red); }
        .footer-main { display: flex; justify-content: space-around; align-items: center; padding: 10px; }
        .res-v { font-size: 1.6rem; font-weight: bold; color: var(--blue); }
        #admin-panel { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 92%; background: white; border-radius: 16px; z-index: 2000; padding: 20px; box-shadow: 0 0 100px rgba(0,0,0,0.5); }
    </style>
</head>
<body>

<div class="header">
    <h1>車両判定システム</h1>
    <button onclick="openAdmin()" style="font-size: 0.7rem; background:none; color:white; border:1px solid white; border-radius:4px; padding:4px 8px;">設定</button>
</div>

<div id="main-content">
    <div class="section-title">リビング</div><div id="list-living"></div>
    <div class="section-title">キッチン</div><div id="list-kitchen"></div>
    <div class="section-title">寝室</div><div id="list-bedroom"></div>
    <div class="section-title">収納・和室</div><div id="list-storage"></div>
    <div class="section-title">書斎・子供部屋</div><div id="list-study"></div>
    <div class="section-title">電化製品</div><div id="list-elec"></div>
    <div class="section-title">水回り・外回り・その他</div><div id="list-misc"></div>
    <div class="section-title">資材</div><div id="list-shizai"></div>
    <div class="section-title">フリー入力</div><div id="list-free" style="padding:10px; background:white;"></div>
</div>

<div class="footer">
    <div class="price-grid">
        <div class="price-box"><div class="price-label">通常</div><span id="price-standard" class="price-val">0</span>円</div>
        <div class="price-box"><div class="price-label">指定</div><span id="price-reserved" class="price-val">0</span>円</div>
    </div>
    <div class="footer-main">
        <div><small>点数</small><br><span id="total-pts" class="res-v">0</span>P</div>
        <div><small>車両</small><br><span id="truck-res" class="res-v" style="color:var(--red);">---</span></div>
        <button onclick="location.reload()" style="background:#666; color:white; border:none; padding:10px 15px; border-radius:8px;">クリア</button>
    </div>
</div>

<div id="admin-panel">
    <h3 style="margin:0 0 10px">料金単価設定</h3>
    <div id="admin-inputs"></div>
    <button onclick="saveAdmin()" style="width:100%; padding:15px; background:var(--blue); color:white; border:none; border-radius:8px; margin-top:10px;">保存</button>
</div>

<script>
// --- 全125項目データ ---
const DATA = {
    living: [
        {n:"ソファー 1人掛", s:"W85 D80 H80", p:9}, {n:"ソファー 2人掛", s:"W140 D85 H80", p:22}, {n:"ソファー 3人掛", s:"W190 D85 H80", p:50}, {n:"ソファー L字セット", s:"-", p:60}, {n:"応接テーブル", s:"W120 D60 H45", p:5}, {n:"サイドボード 大", s:"W150 D45 H90", p:13}, {n:"サイドボード 小", s:"W90 D45 H90", p:8}, {n:"リビングボード", s:"W180 D45 H180", p:35}, {n:"テレビ台 大", s:"W160 D45 H45", p:10}, {n:"テレビ台 小", s:"W90 D45 H45", p:5}, {n:"オーディオラック", s:"W60 D50 H100", p:6}, {n:"ピアノ(アップライト)", s:"W150 D65 H130", p:40}, {n:"電子ピアノ", s:"W140 D45 H80", p:12}, {n:"オルガン", s:"-", p:10}
    ],
    kitchen: [
        {n:"冷蔵庫 5D(大型)", s:"W68 D70 H185", p:25}, {n:"冷蔵庫 3D(中型)", s:"W60 D65 H160", p:14}, {n:"冷蔵庫 2D(小型)", s:"W50 D60 H120", p:7}, {n:"冷蔵庫 1D(パーソナル)", s:"W48 D50 H85", p:3}, {n:"食器棚 特大", s:"W120 D50 H200", p:42}, {n:"食器棚 中", s:"W90 D45 H180", p:25}, {n:"食器棚 小", s:"W60 D45 H90", p:8}, {n:"ダイニングテーブル", s:"W135 D80 H70", p:7}, {n:"ダイニングチェア", s:"W45 D50 H85", p:3}, {n:"レンジ台", s:"W60 D45 H120", p:8}, {n:"電子レンジ", s:"W50 D40 H30", p:2}, {n:"オーブントースター", s:"-", p:1}, {n:"炊飯器", s:"-", p:1}
    ],
    bedroom: [
        {n:"洋タンス 大", s:"W120 D60 H190", p:29}, {n:"洋タンス 中", s:"W90 D60 H190", p:22}, {n:"和タンス", s:"W105 D45 H170", p:18}, {n:"整理タンス", s:"W90 D45 H130", p:15}, {n:"チェスト 大", s:"W120 D45 H90", p:11}, {n:"チェスト 小", s:"W60 D40 H80", p:6}, {n:"ベッド シングル", s:"W100 L200", p:9}, {n:"ベッド セミダブル", s:"W125 L200", p:14}, {n:"ベッド ダブル", s:"W145 L200", p:20}, {n:"ベッド クイーン", s:"W165 L200", p:25}, {n:"ベッド 引出付(S)", s:"W100 L200", p:18}, {n:"折りたたみベッド", s:"W95 L200", p:7}, {n:"二段ベッド", s:"一式", p:25}, {n:"ナイトテーブル", s:"-", p:2}, {n:"ドレッサー", s:"W90 D45 H150", p:12}, {n:"鏡台(三面鏡)", s:"-", p:15}, {n:"布団一式", s:"(袋詰め)", p:5}
    ],
    storage: [
        {n:"衣装ケース(1段)", s:"W40 D70 H25", p:2}, {n:"衣装ケース(3段)", s:"W40 D70 H65", p:5}, {n:"スチールラック 大", s:"W120 D45 H180", p:10}, {n:"スチールラック 小", s:"W90 D45 H120", p:5}, {n:"カラーボックス", s:"W42 D30 H90", p:3}, {n:"押入ダンス", s:"W75 D65 H70", p:7}, {n:"ハンガーラック", s:"-", p:5}, {n:"座卓 大", s:"W120 D90", p:6}, {n:"座卓 小", s:"W90 D60", p:3}, {n:"姿見", s:"H150", p:4}
    ],
    study: [
        {n:"学習机", s:"W110 D65 H110", p:15}, {n:"書棚 大", s:"W90 D30 H180", p:12}, {n:"書棚 小", s:"W60 D30 H90", p:5}, {n:"パソコンデスク", s:"W100 D60", p:6}, {n:"オフィスチェア", s:"-", p:5}, {n:"金庫(小型)", s:"-", p:10}
    ],
    elec: [
        {n:"洗濯機 ドラム", s:"W65 D70 H105", p:12}, {n:"洗濯機 縦型", s:"W55 D55 H95", p:7}, {n:"乾燥機(単体)", s:"-", p:5}, {n:"液晶TV 50型以上", s:"W120～", p:4}, {n:"液晶TV 40型", s:"W95", p:2}, {n:"液晶TV 32型以下", s:"-", p:1}, {n:"エアコン(室内機)", s:"-", p:3}, {n:"エアコン(室外機)", s:"-", p:5}, {n:"掃除機", s:"-", p:2}, {n:"空気清浄機", s:"-", p:2}, {n:"マッサージチェア", s:"-", p:25}
    ],
    misc: [
        {n:"自転車", s:"-", p:15}, {n:"電動自転車", s:"-", p:20}, {n:"三輪車", s:"-", p:3}, {n:"ベビーカー", s:"-", p:4}, {n:"ゴルフバッグ", s:"-", p:3}, {n:"スーツケース", s:"-", p:4}, {n:"ストーブ/ヒーター", s:"-", p:2}, {n:"観葉植物 大", s:"H150～", p:8}, {n:"観葉植物 小", s:"～H100", p:2}, {n:"物干し台(1対)", s:"-", p:6}, {n:"タイヤ(4本)", s:"-", p:10}
    ],
    shizai: [
        {n:"ダンボールA", s:"Mサイズ", p:1}, {n:"ダンボールB", s:"Lサイズ", p:2}, {n:"ハンガーBOX", s:"W50 D50 H100", p:7}, {n:"布団袋(空)", s:"-", p:1}, {n:"オリコン", s:"50L", p:1}, {n:"巻き段ボール", s:"-", p:2}, {n:"台車", s:"-", p:3}
    ]
};

// 以下、スクリプト制御部分は共通（125項目対応版）
let PRICE_TABLE = JSON.parse(localStorage.getItem('sys_prices_vFinal')) || {
    "2T車": [15000, 18000], "2T車L": [20000, 24000], "3T車": [30000, 35000], "2台口以上": [45000, 52000]
};

let counter = 0;
function render(list, targetId) {
    const target = document.getElementById(targetId);
    list.forEach(item => {
        counter++;
        const id = 'q' + counter;
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `<div class="item-info"><span class="item-n">${item.n}<span class="pts-tag">${item.p}P</span></span><span class="item-size">${item.s}</span></div>
            <div class="ctrls"><button class="btn" onclick="chg('${id}',-1)">－</button>
            <input type="number" id="${id}" class="qty-input" value="0" data-pts="${item.p}" oninput="calc()">
            <button class="btn" onclick="chg('${id}',1)">＋</button></div>`;
        target.appendChild(div);
    });
}

function chg(id, d) {
    const el = document.getElementById(id);
    el.value = Math.max(0, (parseInt(el.value) || 0) + d);
    calc();
}

function calc() {
    let total = 0;
    document.querySelectorAll('.qty-input[data-pts]').forEach(el => total += (parseInt(el.value)||0) * parseInt(el.dataset.pts));
    for(let i=1; i<=3; i++) {
        const fq = document.getElementById('fq'+i);
        const fp = document.getElementById('fp'+i);
        if(fq && fp) total += (parseInt(fq.value)||0) * (parseInt(fp.value)||0);
    }
    document.getElementById('total-pts').innerText = total.toLocaleString();

    let truck = "---";
    if (total > 0 && total <= 200) truck = "2T車";
    else if (total > 200 && total <= 260) truck = "2T車L";
    else if (total > 260 && total <= 360) truck = "3T車";
    else if (total > 360) truck = "2台口以上";

    document.getElementById('truck-res').innerText = truck;
    if(truck !== "---" && PRICE_TABLE[truck]) {
        document.getElementById('price-standard').innerText = PRICE_TABLE[truck][0].toLocaleString();
        document.getElementById('price-reserved').innerText = PRICE_TABLE[truck][1].toLocaleString();
    } else {
        document.getElementById('price-standard').innerText = "0";
        document.getElementById('price-reserved').innerText = "0";
    }
}

function openAdmin() {
    if(prompt("パスワード") === "1234") {
        let html = '<table style="width:100%"><tr><th>車両</th><th>通常</th><th>指定</th></tr>';
        for(let k in PRICE_TABLE) {
            html += `<tr><td>${k}</td><td><input type="number" id="std-${k}" value="${PRICE_TABLE[k][0]}" style="width:60px"></td><td><input type="number" id="res-${k}" value="${PRICE_TABLE[k][1]}" style="width:60px"></td></tr>`;
        }
        html += '</table>';
        document.getElementById('admin-inputs').innerHTML = html;
        document.getElementById('admin-panel').style.display = 'block';
    }
}

function saveAdmin() {
    for(let k in PRICE_TABLE) {
        PRICE_TABLE[k] = [Number(document.getElementById(`std-${k}`).value), Number(document.getElementById(`res-${k}`).value)];
    }
    localStorage.setItem('sys_prices_vFinal', JSON.stringify(PRICE_TABLE));
    document.getElementById('admin-panel').style.display = 'none';
    calc();
}

// 実行
for(let cat in DATA) { render(DATA[cat], 'list-' + cat); }

const targetFree = document.getElementById('list-free');
for(let i=1; i<=3; i++) {
    const div = document.createElement('div');
    div.innerHTML = `<div style="display:flex; gap:5px; margin-bottom:5px;"><input type="text" placeholder="品名" style="flex:2; padding:8px; border-radius:5px; border:1px solid #ccc;"><input type="number" id="fp${i}" placeholder="P" style="flex:1; padding:8px; border-radius:5px; border:1px solid #ccc;" oninput="calc()"></div><div style="display:flex; justify-content:flex-end; gap:8px; margin-bottom:15px;"><button class="btn" onclick="chg('fq${i}',-1)">－</button><input type="number" id="fq${i}" class="qty-input" value="0" oninput="calc()"><button class="btn" onclick="chg('fq${i}',1)">＋</button></div>`;
    targetFree.appendChild(div);
}
</script>
</body>
</html>
